CREATE DATABASE centralis;
USE centralis;

CREATE TABLE modulos (
    CodigoModulo ENUM('A','B') PRIMARY KEY
);

CREATE TABLE zonas (
    Zona ENUM('COMEDOR','BAÑO','PATIO','LIBRERIA','CONTROL','ENFERMERIA') PRIMARY KEY
);

CREATE TABLE crimenes (
    IdCrimen INT auto_increment,
    Descripcion VARCHAR(50),
    Condena INT,
    PRIMARY KEY (IdCrimen)
);

CREATE TABLE celdas (
    CodigoCelda INT auto_increment,
    Modulo ENUM('A','B'),
    Abierta TINYINT,
    PRIMARY KEY (CodigoCelda),
    FOREIGN KEY (Modulo) REFERENCES modulos(CodigoModulo) ON DELETE CASCADE
);

CREATE TABLE turnos (
    Turno ENUM('MAÑANA','TARDE','NOCHE') PRIMARY KEY,
    HoraEntrada TIME NOT NULL,
    HoraSalida TIME NOT NULL
);

CREATE TABLE presos (
    NIF CHAR(9) NOT NULL,
    Nombre CHAR(20) NOT NULL,
    Apellidos CHAR(20) NOT NULL,
    Crimen INT,
    Sexo CHAR(1),
    Direccion CHAR(50) NOT NULL,
    CodigoPostal CHAR(5) NOT NULL,
    Correo VARCHAR(50),
    Celda INT,
    Presente TINYINT,
    Telefono VARCHAR(15),
    Foto BLOB,
    PRIMARY KEY (NIF),
    FOREIGN KEY (Celda) REFERENCES celdas(CodigoCelda) ON DELETE SET NULL,
    FOREIGN KEY (Crimen) REFERENCES crimenes(IdCrimen) ON DELETE SET NULL
);

CREATE TABLE empleados (
    NIF CHAR(9) NOT NULL,
    Nombre CHAR(20) NOT NULL,
    Apellidos CHAR(20) NOT NULL,
    Puesto ENUM('VIGILANCIA','LIMPIEZA','COCINA','ENFERMERIA','ADMINISTRACION') NOT NULL,
    Contraseña VARCHAR(30),
    Sexo CHAR(1) NOT NULL,
    Turno ENUM('MAÑANA','TARDE','NOCHE'),
    Direccion CHAR(50) NOT NULL,
    Presente TINYINT,
    CodigoPostal CHAR(5) NOT NULL,
    Correo VARCHAR(50) NOT NULL,
    Telefono VARCHAR(15) NOT NULL,
    Foto BLOB,
    PRIMARY KEY (NIF),
    FOREIGN KEY (Turno) REFERENCES turnos(Turno) ON DELETE SET NULL
);

CREATE TABLE puertas (
    CodigoPuerta INT auto_increment,
    Zona ENUM('COMEDOR','BAÑO','PATIO','LIBRERIA','CONTROL','ENFERMERIA'),
    Modulo ENUM('A','B'),  
    PRIMARY KEY (CodigoPuerta),
    FOREIGN KEY (Zona) REFERENCES zonas(Zona) ON DELETE CASCADE,
    FOREIGN KEY (Modulo) REFERENCES modulos(CodigoModulo) ON DELETE CASCADE
);

CREATE TABLE registros (
    CodigoRegistro INT auto_increment,
    Tipo ENUM('ENTRADA','SALIDA') NOT NULL,
    PresoNIF CHAR(9),
    EmpleadoNIF CHAR(9),
    Motivo CHAR(30),
    Fecha DATETIME NOT NULL,
    PRIMARY KEY (CodigoRegistro),
    FOREIGN KEY (PresoNIF) REFERENCES presos(NIF) ON DELETE SET NULL,
    FOREIGN KEY (EmpleadoNIF) REFERENCES empleados(NIF) ON DELETE SET NULL
);

CREATE TRIGGER after_insert_presos
AFTER INSERT ON presos
FOR EACH ROW
    INSERT INTO registros (Tipo, PresoNIF, Motivo, Fecha)
    VALUES ('ENTRADA', NEW.NIF, 'Ingreso inicial', NOW());
    




INSERT INTO crimenes (Descripcion, Condena) VALUES
('Amenazas leves: Amenazas de causar un mal a una persona sin la intención real de hacerlo.', 3),
('Quebrantamiento de medida cautelar: Violación de una orden judicial, como una prohibición de acercarse a una víctima.', 4),
('Omisión del deber de socorro: No prestar ayuda a una persona que se encuentra en peligro.', 2),
('Delitos contra la integridad moral: Acoso, injurias, calumnias y vejaciones leves.', 3),
('Abandono de menores: Dejar a un menor a su suerte sin la debida atención.', 2),
('Corrupción de menores: Inducir a un menor a participar en actividades sexuales o de otro tipo que puedan perjudicarlo.', 5),
('Trata de seres humanos: Someter a una persona a explotación o esclavitud.', 7),
('Estafa agravada: Estafa que se comete utilizando un medio o instrumento informático o que causa un perjuicio de gran cuantía.', 6),
('Apropiación indebida agravada: Apropiación indebida que se comete utilizando un medio o instrumento informático o que causa un perjuicio de gran cuantía.', 5),
('Daños agravados: Daños que se cometen con el fin de causar un perjuicio de gran cuantía o que afectan a un bien de especial valor histórico, artístico o cultural.', 4),
('Robo con violencia e intimidación en las personas: Robo en el que se utiliza la violencia o la intimidación para sustraer los bienes de la víctima.', 8),
('Robo con fuerza en las cosas: Robo en el que se utiliza la fuerza para acceder a un lugar o para sustraer los bienes de la víctima.', 7),
('Robo en casa habitada: Robo que se comete en una vivienda habitada.', 6),
('Robo en establecimiento abierto al público: Robo que se comete en un establecimiento abierto al público, como una tienda o un restaurante.', 6),
('Sustracción de menores: Sustracción de un menor sin el consentimiento de sus padres o tutores legales.', 5),
('Cultivo o elaboración de drogas tóxicas, estupefacientes y sustancias psicotrópicas: Cultivo o elaboración de drogas con la intención de su distribución o venta.', 9),
('Tenencia de drogas tóxicas, estupefacientes y sustancias psicotrópicas: Posesión de drogas sin autorización para su uso o consumo.', 4),
('Consumo de drogas tóxicas, estupefacientes y sustancias psicotrópicas: Consumo de drogas en un lugar público o que ponga en peligro la seguridad de uno mismo o de terceros.', 3),
('Conducción bajo la influencia de drogas tóxicas, estupefacientes y sustancias psicotrópicas: Conducir un vehículo bajo la influencia de drogas, lo que pone en peligro la seguridad vial.', 5),
('Negociaciones prohibidas a funcionarios públicos: Realización de negocios incompatibles con el cargo que se ocupa.', 3),
('Malversación de fondos públicos agravada: Malversación de fondos públicos que causa un perjuicio de gran cuantía.', 7),
('Prevaricación agravada: Prevaricación que se comete con el fin de obtener un beneficio patrimonial o de causar un perjuicio de gran cuantía.', 6),
('Cohecho agravado: Cohecho en el que se ofrece o se solicita un soborno de gran cuantía.', 8),
('Provocación a la rebelión: Incitar a la población a rebelarse contra las autoridades.', 6),
('Terrorismo agravado: Terrorismo que causa un grave perjuicio a la vida, la integridad física o la salud de las personas o que produce un grave daño a la propiedad pública o privada.', 10),
('Asesinato de agente de la autoridad: Asesinato de un agente de la autoridad que se encuentra en el ejercicio de sus funciones.', 9),
('Vertidos y emisiones contaminantes: Vertido o emisión de sustancias nocivas que contaminan el medio ambiente.', 4),
('Daños a la naturaleza agravados: Daños a la naturaleza que afectan a un espacio natural protegido o que causan un grave perjuicio al medio ambiente.', 6),
('Tráfico ilegal de especies protegidas: Compra, venta o transporte de especies animales o vegetales protegidas por la ley.', 5),
('Reproducción, distribución o transformación sin autorización de una obra protegida por derechos de autor.', 4),
('Violación de secretos industriales.', 7),
('Fraude fiscal: Evitar el pago de impuestos de forma fraudulenta.', 8),
('Alzamiento de bienes: Ocultar o transferir bienes para evitar el pago de deudas.', 5),
('Insolvencia punible agravada: Bancarrota fraudulenta o por imprudencia grave que causa un perjuicio de gran cuantía.', 7),
('Blanqueo de capitales agravado: Blanqueo de capitales que se realiza utilizando el sistema financiero o que causa un perjuicio de gran cuantía.', 9),
('Amenazas a los trabajadores: Amenazar a un trabajador para que realice o deje de realizar una determinada actividad laboral.', 4),
('Coacciones a los trabajadores: Coaccionar a un trabajador para que realice o deje de realizar una determinada actividad laboral.', 3),
('Obstrucción a la libertad sindical: Impedir o dificultar el ejercicio del derecho de sindicación de los trabajadores.', 3),
('Conducción temeraria con manifiesto desprecio por la vida de los demás.', 6),
('Omisión del deber de socorro en accidente de tráfico.', 5),
('Allanamiento de morada: Entrar en un domicilio ajeno sin autorización.', 4),
('Violencia doméstica: Violencia física o psíquica ejercida sobre un familiar.', 5),
('Sustracción de menores por un progenitor: Sustracción de un menor por parte de uno de sus progenitores sin el consentimiento del otro.', 7),
('Impago de pensiones: Incumplimiento de la obligación legal de pagar una pensión alimenticia.', 4),
('Acoso sexual: Acoso de naturaleza sexual que crea un entorno hostil o humillante para la víctima.', 5),
('Exhibicionismo y provocación sexual: Realizar actos de exhibición o provocación sexual en lugares públicos o que puedan ser observados por menores.', 3),
('Pornografía infantil: Producción, posesión o distribución de material pornográfico con menores.', 8),
('Atentado contra el Rey: Violencia o atentado contra la persona del Rey.', 6),
('Rebelión: Alzamiento violento contra las autoridades del Estado.', 9),
('Falsificación de documento público: Falsificación de un documento oficial.', 7),
('Lesiones por imprudencia: Lesiones causadas a otra persona por imprudencia grave o leve.', 4),
('Abandono de familia: Dejar de prestar la debida asistencia a un familiar que la necesita.', 3),
('Delitos contra el honor: Injurias graves y calumnias graves.', 5),
('Provocación al suicidio: Inducir a una persona a suicidarse.', 4),
('Omisión del deber de socorro: No prestar ayuda a una persona que se encuentra en peligro de muerte.', 2),
('Estafa informática: Fraude realizado mediante el uso de un sistema informático.', 6),
('Apropiación indebida informática: Apropiación indebida realizada mediante el uso de un sistema informático.', 5),
('Daños informáticos: Daño o destrucción de datos o sistemas informáticos.', 4),
('Espionaje industrial: Obtención de información confidencial de un competidor para su propio beneficio.', 7),
('Receptación: Adquisición de bienes procedentes de un delito.', 5),
('Cultivo o elaboración de drogas sintéticas: Cultivo o elaboración de drogas sintéticas, como las anfetaminas o el MDMA.', 8),
('Tráfico de medicamentos: Compra, venta o distribución de medicamentos sin autorización.', 6),
('Dopaje deportivo: Uso de sustancias o métodos prohibidos para mejorar el rendimiento deportivo.', 5),
('Publicidad engañosa sobre productos sanitarios: Publicidad que atribuye propiedades curativas o preventivas a un producto sanitario que no las posee.', 4),
('Experimentación ilegal con medicamentos: Experimentación con medicamentos en seres humanos sin autorización.', 7),
('Abuso de autoridad: Uso indebido de las funciones públicas en beneficio propio o de terceros.', 5),
('Disposición indebida de fondos públicos: Destinar fondos públicos a un fin distinto para el que fueron asignados.', 6),
('Fraude de subvenciones: Obtención de una subvención de forma fraudulenta.', 7),
('Malversación de caudales públicos agravada por funcionario público: Apropiación indebida de fondos públicos por parte de un funcionario público que causa un grave perjuicio a la Administración Pública.', 9),
('Prevaricación urbanística: Dictado de una resolución urbanística injusta a cambio de un soborno o de otra recompensa.', 7),
('Desórdenes públicos graves: Alteración grave del orden público mediante violencia, intimidación o resistencia a la autoridad.', 6),
('Daños: Destrucción o deterioro de una cosa ajena sin la intención de causar un perjuicio de gran cuantía.', 4),
('Amenazas graves: Amenazas de causar un mal grave a una persona con la intención real de hacerlo.', 5),
('Provocación a la rebelión agravada: Incitar a la población a rebelarse contra las autoridades con el fin de causar un grave perjuicio a la seguridad pública.', 8),
('Terrorismo de carácter internacional: Terrorismo que se comete en el territorio de otro Estado o que tiene como objetivo a personas o bienes de otro Estado.', 9),
('Tráfico ilegal de residuos: Compra, venta o transporte de residuos peligrosos sin autorización.', 7),
('Contaminación acústica: Emisión de ruidos que superan los límites legales y que pueden causar molestias o perjuicios a la salud de las personas.', 3),
('Actividades prohibidas en espacios naturales protegidos: Realización de actividades prohibidas en un espacio natural protegido, como la caza o la pesca.', 4),
('Daños a la biodiversidad: Destrucción o deterioro de la biodiversidad, como la extinción de una especie animal o vegetal.', 6),
('Introducción de especies exóticas invasoras: Introducción de especies exóticas invasoras en el medio natural que pueden causar daños a la flora o fauna autóctona.', 5),
('Comunicación pública no autorizada de una obra protegida por derechos de autor.', 4),
('Distribución ilícita de fonogramas y videogramas.', 5),
('Concurso de acreedores fraudulento: Solicitud de declaración de concurso de acreedores con la intención de ocultar bienes o perjudicar a los acreedores.', 6),
('Vulneración de los derechos de los representantes de los trabajadores: Impedir o dificultar el ejercicio de las funciones de los representantes de los trabajadores.', 4),
('Despido colectivo improcedente: Despido colectivo que no se ajusta a las causas o procedimientos legalmente establecidos.', 5),
('Fraude a la Seguridad Social: Obtención indebida de prestaciones o cotizaciones a la Seguridad Social.', 6),
('Simulación de incapacidad laboral: Fingir una enfermedad o lesión para obtener una prestación de incapacidad laboral.', 4),
('Explotación sexual: Explotación de la prostitución ajena.', 7),
('Corrupción de menores: Inducir o forzar a un menor a ejercer la prostitución.', 6),
('Trata de seres humanos con fines de explotación sexual: Someter a una persona a la prostitución mediante engaño, coacción o violencia.', 9),
('Violación de secretos comerciales.', 6),
('Imitación ilícita: Imitación de un producto o servicio para confundirlo con otro ya existente.', 4),
('Falsificación de medicamentos: Fabricación o comercialización de medicamentos falsos.', 6),
('Venta de medicamentos caducados: Venta de medicamentos que han superado su fecha de caducidad.', 5),
('Conducción bajo los efectos del alcohol: Conducir un vehículo con una tasa de alcohol en sangre superior a la permitida legalmente.', 4),
('Velocidad excesiva: Conducir un vehículo a una velocidad superior a la permitida en la vía.', 5),
('Omisión del seguro obligatorio de responsabilidad civil: Conducir un vehículo sin tener contratado el seguro obligatorio.', 4),
('Estafa continuada: Realización habitual de estafas de pequeña cuantía.', 5),
('Falsedad en la propiedad industrial: Falsificación de marcas o patentes.', 6),
('Publicidad engañosa: Publicidad que contiene información falsa o engañosa sobre un producto o servicio.', 4),
('Delito de odio: Discriminación o incitación al odio contra una persona o grupo por motivos de raza, origen étnico, religión, sexo, orientación sexual, identidad sexual, discapacidad o enfermedad.', 5),
('Tortura: Infligir a una persona dolores o sufrimientos graves, ya sean físicos o mentales, con el fin de obtener de ella una confesión o información, o de castigarla por un acto que haya cometido o se sospeche que haya cometido, o de intimidarla o a otras personas.', 9),
('Omisión del deber de socorro: No prestar ayuda a una persona que se encuentra en peligro.', 2),
('Injurias a la Corona: Injurias dirigidas al Rey o a la Reina.', 5),
('Enaltecimiento del terrorismo: Justificación o elogio de los actos terroristas.', 6),
('Expoliación del patrimonio histórico: Robo o destrucción de bienes de valor histórico o cultural.', 7),
('Descubrimiento y revelación de secretos: Descubrir o revelar sin autorización secretos ajenos.', 4),
('Interceptación ilegal de las comunicaciones: Interceptar sin autorización las comunicaciones de otra persona.', 5),
('Stalking: Acoso a una persona a través de medios informáticos o de comunicación.', 4),
('Grooming: Acoso a un menor de edad con fines sexuales a través de medios informáticos o de comunicación.', 6);





INSERT INTO modulos (CodigoModulo) VALUES ('A'), ('B');


INSERT INTO celdas (Modulo, Abierta) VALUES
('A', 0),
('A', 0),
('A', 0),
('A', 0),
('A', 0),
('A', 0),
('A', 0),
('A', 0),
('A', 0),
('A', 0),
('A', 0),
('A', 0),
('A', 0),
('A', 0),
('A', 0),
('A', 0),
('A', 0),
('A', 0),
('A', 0),
('A', 0),
('A', 0),
('A', 0),
('A', 0),
('A', 0),
('A', 0),
('A', 0),
('A', 0),
('A', 0),
('A', 0),
('A', 0),
('B', 0),
('B', 0),
('B', 0),
('B', 0),
('B', 0),
('B', 0),
('B', 0),
('B', 0),
('B', 0),
('B', 0),
('B', 0),
('B', 0),
('B', 0),
('B', 0),
('B', 0),
('B', 0),
('B', 0),
('B', 0),
('B', 0),
('B', 0),
('B', 0),
('B', 0),
('B', 0),
('B', 0),
('B', 0),
('B', 0),
('B', 0),
('B', 0),
('B', 0),
('B', 0);

   

INSERT INTO presos (NIF, Nombre, Apellidos, Crimen, Sexo, Direccion, CodigoPostal, Correo, Celda, Telefono, Foto) VALUES
('12345678Z', 'Carlos', 'Gomez', 12, 'M', 'Calle Falsa 123', '28080', 'carlos.gomez@example.com', 10, '600123456', NULL),
('23456789S', 'Luis', 'Perez', 21, 'M', 'Plaza Mayor 1', '28081', 'luis.perez@example.com', 12, '600234567', NULL),
('34567890J', 'Jose', 'Lopez', 5, 'M', 'Calle Luna 3', '28082', 'jose.lopez@example.com', 3, '600345678', NULL),
('45678901N', 'Juan', 'Garcia', 4, 'M', 'Calle Serrano 7', '28083', 'juan.garcia@example.com', 4, '600456789', NULL),
('56789012Y', 'Antonio', 'Hernandez', 13, 'M', 'Calle Goya 9', '28084', 'antonio.hernandez@example.com', 5, '600567890', NULL),
('67890123F', 'Pedro', 'Morales', 1, 'M', 'Avenida Gran Via 5', '28085', 'pedro.morales@example.com', 6, '600678901', NULL),
('78901234D', 'Miguel', 'Ruiz', 8, 'M', 'Calle Castellana 11', '28086', 'miguel.ruiz@example.com', 7, '600789012', NULL),
('89012345T', 'David', 'Navarro', 3, 'M', 'Calle Fuencarral 13', '28087', 'david.navarro@example.com', 3, '600890123', NULL),
('90123456C', 'Javier', 'Martinez', 2, 'M', 'Calle Alcalá 6', '28088', 'javier.martinez@example.com', 10, '600901234', NULL),
('01234567L', 'Ricardo', 'Blanco', 6, 'M', 'Calle Velazquez 10', '28089', 'ricardo.blanco@example.com', 12, '600012345', NULL),
('12345678P', 'Hector', 'Fernandez', 14, 'M', 'Calle Preciados 12', '28090', 'hector.fernandez@example.com', 13, '600123456', NULL),
('23456789Y', 'Alberto', 'Ortega', 9, 'M', 'Calle Serrano 15', '28091', 'alberto.ortega@example.com', 14, '600234567', NULL),
('34567890U', 'Sergio', 'Ramirez', 11, 'M', 'Calle Mayor 8', '28092', 'sergio.ramirez@example.com', 15, '600345678', NULL),
('45678901S', 'Francisco', 'Mendez', 7, 'M', 'Calle Goya 12', '28093', 'francisco.mendez@example.com', 16, '600456789', NULL),
('56789012T', 'Raul', 'Suarez', 10, 'M', 'Calle Fuencarral 17', '28094', 'raul.suarez@example.com', 17, '600567890', NULL);



